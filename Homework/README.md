﻿Heroes of Pymoli Data Analysis1. A majority of the purchases are made by people under 30. People between the ages of 20 - 24 make the most purchases however they do not make the most expensive purchases2. The most popular items are below the average purchase price3. The most profitable items are priced higher than the average price while the most popular are priced below the average.```python#Import Dependenciesimport pandas as pd``````python# Create a path to the json and  read it into a Pandas DataFramejson_path = "HeroesOfPymoli/purchase_data.json"heroes_df = pd.read_json(json_path)heroes_df.head()```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Age</th>      <th>Gender</th>      <th>Item ID</th>      <th>Item Name</th>      <th>Price</th>      <th>SN</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>38</td>      <td>Male</td>      <td>165</td>      <td>Bone Crushing Silver Skewer</td>      <td>3.37</td>      <td>Aelalis34</td>    </tr>    <tr>      <th>1</th>      <td>21</td>      <td>Male</td>      <td>119</td>      <td>Stormbringer, Dark Blade of Ending Misery</td>      <td>2.32</td>      <td>Eolo46</td>    </tr>    <tr>      <th>2</th>      <td>34</td>      <td>Male</td>      <td>174</td>      <td>Primitive Blade</td>      <td>2.46</td>      <td>Assastnya25</td>    </tr>    <tr>      <th>3</th>      <td>21</td>      <td>Male</td>      <td>92</td>      <td>Final Critic</td>      <td>1.36</td>      <td>Pheusrical25</td>    </tr>    <tr>      <th>4</th>      <td>23</td>      <td>Male</td>      <td>63</td>      <td>Stormfury Mace</td>      <td>1.27</td>      <td>Aela59</td>    </tr>  </tbody></table></div>```python#Find Player Countplayer_count = heroes_df["SN"].nunique()player_countplayer_count_df = pd.DataFrame({'Total Players' : [player_count]})player_count_df```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Total Players</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>573</td>    </tr>  </tbody></table></div>```python#Number of Unique Itemsunique_items = heroes_df["Item Name"].nunique()#Average Purchase Priceaverage_price = heroes_df["Price"].mean()#Total Number of PurchasesTotal_purchases = heroes_df["Price"].count()#Total RevenueTotal_Revenue = heroes_df["Price"].sum()purchase_analysis_df = pd.DataFrame({'Unique Items' : [unique_items],                                     'Average Purchase Price' : [average_price],                                     'Total Purchases': [Total_purchases],                                     'Total Revenue' : [Total_Revenue]})purchase_analysis_df['Average Purchase Price'] = purchase_analysis_df['Average Purchase Price'].map("${:.2f}".format)purchase_analysis_df['Total Revenue'] = purchase_analysis_df['Total Revenue'].map("${:,.2f}".format)purchase_analysis_df```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Average Purchase Price</th>      <th>Total Purchases</th>      <th>Total Revenue</th>      <th>Unique Items</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>$2.93</td>      <td>780</td>      <td>$2,286.33</td>      <td>179</td>    </tr>  </tbody></table></div>```python#Percentage and Count Per Gendermale_players = heroes_df.loc[heroes_df["Gender"] == "Male"]male_count = male_players["SN"].nunique()male_percent = (male_count/player_count)*100female_players = heroes_df.loc[heroes_df["Gender"] == "Female"]female_count = female_players["SN"].nunique()female_percent = (female_count/player_count)*100other_players = heroes_df.loc[~heroes_df["Gender"].isin(["Male","Female"])]other_count = other_players["SN"].nunique()other_percent = (other_count/player_count)*100gender_df = pd.DataFrame({'Gender' : ["Male", "Female", "Other/Non-disclosed"],                          'Percentage of Players' : [male_percent, female_percent, other_percent],                          'Total Count' : [male_count, female_count, other_count]})gender_df = gender_df.set_index('Gender')gender_df['Percentage of Players'] = gender_df['Percentage of Players'].map("{:.2f}%".format)gender_df['Total Count'] = gender_df['Total Count'].map("{:}".format)gender_df                                                ```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Percentage of Players</th>      <th>Total Count</th>    </tr>    <tr>      <th>Gender</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Male</th>      <td>81.15%</td>      <td>465</td>    </tr>    <tr>      <th>Female</th>      <td>17.45%</td>      <td>100</td>    </tr>    <tr>      <th>Other/Non-disclosed</th>      <td>1.40%</td>      <td>8</td>    </tr>  </tbody></table></div>```python#purchase analysis by gendermale_purchase = male_players["Price"].count()male_total_value = male_players["Price"].sum()male_average = male_players["Price"].mean()male_norm = male_total_value/male_countfemale_purchase = female_players["Price"].count()female_total_value = female_players["Price"].sum()female_average = female_players["Price"].mean()female_norm = female_total_value/female_countother_purchase = other_players["Price"].count()other_total_value = other_players["Price"].sum()other_average = other_players["Price"].mean()other_norm = other_total_value/other_countgender_purchase_df = pd.DataFrame({"Gender" : ["Male", "Female", "Other/Non-Disclosed"],                                  "Purchase Count" : [male_purchase, female_purchase, other_purchase],                                  "Average Purchase Price" : [male_average, female_average, other_average],                                  "Total Purchase Price" : [male_total_value, female_total_value, other_total_value],                                  "Normalized Totals" :[male_norm, female_norm, other_norm]})gender_purchase_df = gender_purchase_df.set_index("Gender")gender_purchase_df['Total Purchase Price'] = gender_purchase_df['Total Purchase Price'].map("${:,.2f}".format)gender_purchase_df['Average Purchase Price'] = gender_purchase_df['Average Purchase Price'].map("${:.2f}".format)gender_purchase_df['Normalized Totals'] = gender_purchase_df['Normalized Totals'].map("${:.2f}".format)gender_purchase_df```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Average Purchase Price</th>      <th>Normalized Totals</th>      <th>Purchase Count</th>      <th>Total Purchase Price</th>    </tr>    <tr>      <th>Gender</th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Male</th>      <td>$2.95</td>      <td>$4.02</td>      <td>633</td>      <td>$1,867.68</td>    </tr>    <tr>      <th>Female</th>      <td>$2.82</td>      <td>$3.83</td>      <td>136</td>      <td>$382.91</td>    </tr>    <tr>      <th>Other/Non-Disclosed</th>      <td>$3.25</td>      <td>$4.47</td>      <td>11</td>      <td>$35.74</td>    </tr>  </tbody></table></div>```python#age demographics#print(heroes_df["Age"].max())#print(heroes_df["Age"].min())#Create Binsbins = [0, 10, 15, 20, 25, 30, 35, 40, 150]group_names = ['<10', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40+']#new dataframe and groupbyage_summary_df = heroes_df.copy()age_summary_df["Age_Range"] = pd.cut(age_summary_df["Age"], bins, labels=group_names)age_groups = age_summary_df.groupby(["Age_Range"])age_count = age_groups["SN"].count()age_percentage = (age_count/player_count)*100age_df = pd.DataFrame({"Total Count" : age_count,                      "Percentage of Players" : age_percentage})age_df['Percentage of Players'] = age_df['Percentage of Players'].map("{:.2f}%".format)age_df```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Percentage of Players</th>      <th>Total Count</th>    </tr>    <tr>      <th>Age_Range</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>&lt;10</th>      <td>5.58%</td>      <td>32</td>    </tr>    <tr>      <th>10-14</th>      <td>13.61%</td>      <td>78</td>    </tr>    <tr>      <th>15-19</th>      <td>32.11%</td>      <td>184</td>    </tr>    <tr>      <th>20-24</th>      <td>53.23%</td>      <td>305</td>    </tr>    <tr>      <th>25-29</th>      <td>13.26%</td>      <td>76</td>    </tr>    <tr>      <th>30-34</th>      <td>10.12%</td>      <td>58</td>    </tr>    <tr>      <th>35-39</th>      <td>7.68%</td>      <td>44</td>    </tr>    <tr>      <th>40+</th>      <td>0.52%</td>      <td>3</td>    </tr>  </tbody></table></div>```python#Age Analysisunique_age_group = age_groups['SN'].nunique()age_purchase = age_groups["Price"].count()age_average = age_groups["Price"].mean()age_total = age_groups["Price"].sum()age_norm = age_total/unique_age_groupage_analysis_df = pd.DataFrame({"Purchase Count" : age_purchase,                              "Average Purchase Price" : age_average,                              "Total Purchase Price" : age_total,                              "Normalized Totals" : age_norm})age_analysis_df['Total Purchase Price'] = age_analysis_df['Total Purchase Price'].map("${:,.2f}".format)age_analysis_df['Average Purchase Price'] = age_analysis_df['Average Purchase Price'].map("${:.2f}".format)age_analysis_df['Normalized Totals'] = age_analysis_df['Normalized Totals'].map("${:.2f}".format)age_analysis_df```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Average Purchase Price</th>      <th>Normalized Totals</th>      <th>Purchase Count</th>      <th>Total Purchase Price</th>    </tr>    <tr>      <th>Age_Range</th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>&lt;10</th>      <td>$3.02</td>      <td>$4.39</td>      <td>32</td>      <td>$96.62</td>    </tr>    <tr>      <th>10-14</th>      <td>$2.87</td>      <td>$4.15</td>      <td>78</td>      <td>$224.15</td>    </tr>    <tr>      <th>15-19</th>      <td>$2.87</td>      <td>$3.80</td>      <td>184</td>      <td>$528.74</td>    </tr>    <tr>      <th>20-24</th>      <td>$2.96</td>      <td>$3.86</td>      <td>305</td>      <td>$902.61</td>    </tr>    <tr>      <th>25-29</th>      <td>$2.89</td>      <td>$4.23</td>      <td>76</td>      <td>$219.82</td>    </tr>    <tr>      <th>30-34</th>      <td>$3.07</td>      <td>$4.05</td>      <td>58</td>      <td>$178.26</td>    </tr>    <tr>      <th>35-39</th>      <td>$2.90</td>      <td>$5.10</td>      <td>44</td>      <td>$127.49</td>    </tr>    <tr>      <th>40+</th>      <td>$2.88</td>      <td>$2.88</td>      <td>3</td>      <td>$8.64</td>    </tr>  </tbody></table></div>```python#Top SpendersSN_group = heroes_df.groupby(["SN"])player_purchase_count = SN_group["Price"].count()player_purchase_total = SN_group["Price"].sum()player_purchase_average = SN_group["Price"].mean()top_spender_df = pd.DataFrame({"Purchase Count" : player_purchase_count,                              "Average Purchase Price" : player_purchase_average,                              "Total Purchase Value" : player_purchase_total})top_spender_df.sort_values("Total Purchase Value", ascending=False, inplace=True)top_spender_df["Total Purchase Value"] = top_spender_df["Total Purchase Value"].map("${:.2f}".format)top_spender_df["Average Purchase Price"] = top_spender_df["Average Purchase Price"].map("${:.2f}".format)top_spender_df.head()```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Average Purchase Price</th>      <th>Purchase Count</th>      <th>Total Purchase Value</th>    </tr>    <tr>      <th>SN</th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Undirrala66</th>      <td>$3.41</td>      <td>5</td>      <td>$17.06</td>    </tr>    <tr>      <th>Saedue76</th>      <td>$3.39</td>      <td>4</td>      <td>$13.56</td>    </tr>    <tr>      <th>Mindimnya67</th>      <td>$3.18</td>      <td>4</td>      <td>$12.74</td>    </tr>    <tr>      <th>Haellysu29</th>      <td>$4.24</td>      <td>3</td>      <td>$12.73</td>    </tr>    <tr>      <th>Eoda93</th>      <td>$3.86</td>      <td>3</td>      <td>$11.58</td>    </tr>  </tbody></table></div>```python# Most popular item#Create new dataframe for most popular itempopular_group = heroes_df.groupby(["Item ID"])purchase_count = popular_group["Price"].count()purchase_total = popular_group["Price"].sum()top_item_df = pd.DataFrame({"Purchase Count" : purchase_count,                            "Total Purchase Value" : purchase_total})#Remove duplicates from OG dataframe and keep only columns neededdrop_dups_df = heroes_df.drop_duplicates(["Item ID"], keep = "last")item_id_index_df = drop_dups_df.set_index('Item ID')item_id_index_df = item_id_index_df[["Item Name", "Price"]]#combine two dataframes to get all the information neededframes = [top_item_df, item_id_index_df]top_item_df = pd.concat(frames, axis=1)top_item_df.sort_values("Purchase Count", ascending=False, inplace=True)#format columnstop_item_df["Total Purchase Value"] = top_item_df["Total Purchase Value"].map("${:.2f}".format)top_item_df["Price"] = top_item_df["Price"].map("${:.2f}".format)top_item_df = top_item_df[["Item Name", "Purchase Count", "Price", "Total Purchase Value"]]top_item_df.head()```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item Name</th>      <th>Purchase Count</th>      <th>Price</th>      <th>Total Purchase Value</th>    </tr>    <tr>      <th>Item ID</th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>39</th>      <td>Betrayal, Whisper of Grieving Widows</td>      <td>11</td>      <td>$2.35</td>      <td>$25.85</td>    </tr>    <tr>      <th>84</th>      <td>Arcane Gem</td>      <td>11</td>      <td>$2.23</td>      <td>$24.53</td>    </tr>    <tr>      <th>31</th>      <td>Trickster</td>      <td>9</td>      <td>$2.07</td>      <td>$18.63</td>    </tr>    <tr>      <th>175</th>      <td>Woeful Adamantite Claymore</td>      <td>9</td>      <td>$1.24</td>      <td>$11.16</td>    </tr>    <tr>      <th>13</th>      <td>Serenity</td>      <td>9</td>      <td>$1.49</td>      <td>$13.41</td>    </tr>  </tbody></table></div>```python#Most Profitable Items#Create new dataframe for most popular itemprofit_group = heroes_df.groupby(["Item ID"])profit_purchase_count = profit_group["Price"].count()profit_purchase_total = profit_group["Price"].sum()profitable_item_df = pd.DataFrame({"Purchase Count" : purchase_count,                            "Total Purchase Value" : purchase_total})frames = [profitable_item_df, item_id_index_df]profitable_item_df = pd.concat(frames, axis=1)profitable_item_df.sort_values("Total Purchase Value", ascending=False, inplace=True)profitable_item_df["Total Purchase Value"] = profitable_item_df["Total Purchase Value"].map("${:.2f}".format)profitable_item_df["Price"] = profitable_item_df["Price"].map("${:.2f}".format)profitable_item_df = profitable_item_df[["Item Name", "Purchase Count", "Price", "Total Purchase Value"]]profitable_item_df.head()```<div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>Item Name</th>      <th>Purchase Count</th>      <th>Price</th>      <th>Total Purchase Value</th>    </tr>    <tr>      <th>Item ID</th>      <th></th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>34</th>      <td>Retribution Axe</td>      <td>9</td>      <td>$4.14</td>      <td>$37.26</td>    </tr>    <tr>      <th>115</th>      <td>Spectral Diamond Doomblade</td>      <td>7</td>      <td>$4.25</td>      <td>$29.75</td>    </tr>    <tr>      <th>32</th>      <td>Orenmir</td>      <td>6</td>      <td>$4.95</td>      <td>$29.70</td>    </tr>    <tr>      <th>103</th>      <td>Singed Scalpel</td>      <td>6</td>      <td>$4.87</td>      <td>$29.22</td>    </tr>    <tr>      <th>107</th>      <td>Splitter, Foe Of Subtlety</td>      <td>8</td>      <td>$3.61</td>      <td>$28.88</td>    </tr>  </tbody></table></div>